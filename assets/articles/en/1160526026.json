{"url": "https://api.github.com/repos/kemu3007/portal/issues/2", "repository_url": "https://api.github.com/repos/kemu3007/portal", "labels_url": "https://api.github.com/repos/kemu3007/portal/issues/2/labels{/name}", "comments_url": "https://api.github.com/repos/kemu3007/portal/issues/2/comments", "events_url": "https://api.github.com/repos/kemu3007/portal/issues/2/events", "html_url": "https://github.com/kemu3007/portal/issues/2", "id": 1160526026, "node_id": "I_kwDOG7qoq85FLDjK", "number": 2, "title": "Stops clogged with Google AdSense, site configuration, etc.", "user": {"login": "kemu3007", "id": 29157528, "node_id": "MDQ6VXNlcjI5MTU3NTI4", "avatar_url": "https://avatars.githubusercontent.com/u/29157528?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kemu3007", "html_url": "https://github.com/kemu3007", "followers_url": "https://api.github.com/users/kemu3007/followers", "following_url": "https://api.github.com/users/kemu3007/following{/other_user}", "gists_url": "https://api.github.com/users/kemu3007/gists{/gist_id}", "starred_url": "https://api.github.com/users/kemu3007/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kemu3007/subscriptions", "organizations_url": "https://api.github.com/users/kemu3007/orgs", "repos_url": "https://api.github.com/users/kemu3007/repos", "events_url": "https://api.github.com/users/kemu3007/events{/privacy}", "received_events_url": "https://api.github.com/users/kemu3007/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3898939400, "node_id": "LA_kwDOG7qoq87oZRgI", "url": "https://api.github.com/repos/kemu3007/portal/labels/article", "name": "article", "color": "C200E5", "default": false, "description": ""}, {"id": 3900082041, "node_id": "LA_kwDOG7qoq87odod5", "url": "https://api.github.com/repos/kemu3007/portal/labels/Utils", "name": "Utils", "color": "170627", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-03-06T05:51:34Z", "updated_at": "2022-04-04T05:16:06Z", "closed_at": null, "author_association": "OWNER", "active_lock_reason": null, "body": "The composition of this site is\r\n\r\n`Name Dotcom-> Route 53-> AWS Alb- (HTTP1.1)> AWS EC2`\r\n\r\nIt is in the form. At the beginning of the implementation\r\n\r\n`Name Dotcom-> AWS Alb- (http2.0)> AWS EC2`\r\n\r\nIt was like this due to the specification of & alb to register with AdSense.\r\n\r\nThere were about two points that stumbled on Adsense, so leave a note.\r\n\r\n## 1. If you try to register with Adsense, you will not be able to reach the site\r\n\r\nIn conclusion, [http error 464] (https://docs.aws.amazon.com/ja_jp/elasticloadBalance/latest/application/load-balancer-troubleShooting.html# ã€‚\r\n\r\nIt seems that the http, which had been requested, and the protocol inside the load balancer did not match and spit out an error.\r\n\r\nThe communication to the ALB target group was set to http1.1, and the nginx on EC2 was also required to HTTP1.1.\r\n\r\nWhen I was feeding the site map in Google Search Console, a 464 error was displayed on the screen.\r\n\r\n\r\n### measures\r\n`` `bash\r\ncurl http://example.com/ --http1.1\r\ncurl http://example.com/ --http2\r\n`` `\r\n\r\nIt is necessary to check using the Curl command at hand.\r\n\r\n\r\n---\r\n\r\n## 2. Name Dotcom can only register CNAME records in the subdomain\r\n\r\nThe IP address is assigned to ALB, but the IP address changes when it scale out instead of fixed.\r\n\r\nTherefore, the DNS name is assigned and it is necessary to create a CNAME record in the DNS setting of the domain.\r\n\r\nHowever, the name dot com does not allow CNAME records other than subdomain. So I thought that my name dot com was hard to get on the whole, so I decided to transfer the domain to Route53, but I couldn't do that.\r\n\r\nThere was a limit on the top domain that can be managed by Route53, and `Site` was not eligible.\r\n\r\n[Host domain that can be registered in Amazon Route 53] (https://docs.aws.amazon.com/ja_jp/route53/late53/lateSt/developerguide/registrar-tld-list.html)\r\n\r\nTherefore, we made a zone with Route53, set the NS described in the created zone to NS on the name dot com side, and fix it from Route53 to ALB.\r\n\r\n* There is also a method of assigning and using IP addresses using AWS Global Accelerator, but this time I do not want to spend money & it seems to be quite expensive, so I did not see it.\r\nSince the performance is improved, I think that it is okay to put it if it is a severe project.\r\n\r\n[AWS Global Accelerator](https://aws.amazon.com/jp/global-accelerator/?blogs-global-accelerator.sort-by=item.additionalFields.createdDate&blogs-global-accelerator.sort-order=desc&aws-global -accelatorator-wn.sort-by = Item.additionalFields.postdateTime & aws-global-Accelerator-Wn.sort-4\r\n\r\n\r\n---\r\n\r\nWith an error that you can't reach the site, you can google and just come up with the paid information of the Hatena blog (the redirect setting for www.) It took a long time to elucidate the cause, but it was good to solve it.", "reactions": {"url": "https://api.github.com/repos/kemu3007/portal/issues/2/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/kemu3007/portal/issues/2/timeline", "performed_via_github_app": null, "state_reason": null}