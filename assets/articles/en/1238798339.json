{"url": "https://api.github.com/repos/kemu3007/portal/issues/44", "repository_url": "https://api.github.com/repos/kemu3007/portal", "labels_url": "https://api.github.com/repos/kemu3007/portal/issues/44/labels{/name}", "comments_url": "https://api.github.com/repos/kemu3007/portal/issues/44/comments", "events_url": "https://api.github.com/repos/kemu3007/portal/issues/44/events", "html_url": "https://github.com/kemu3007/portal/issues/44", "id": 1238798339, "node_id": "I_kwDOG7qoq85J1pAD", "number": 44, "title": "Deploy SPA to GitHub Pages while thinking about SEO", "user": {"login": "kemu3007", "id": 29157528, "node_id": "MDQ6VXNlcjI5MTU3NTI4", "avatar_url": "https://avatars.githubusercontent.com/u/29157528?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kemu3007", "html_url": "https://github.com/kemu3007", "followers_url": "https://api.github.com/users/kemu3007/followers", "following_url": "https://api.github.com/users/kemu3007/following{/other_user}", "gists_url": "https://api.github.com/users/kemu3007/gists{/gist_id}", "starred_url": "https://api.github.com/users/kemu3007/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kemu3007/subscriptions", "organizations_url": "https://api.github.com/users/kemu3007/orgs", "repos_url": "https://api.github.com/users/kemu3007/repos", "events_url": "https://api.github.com/users/kemu3007/events{/privacy}", "received_events_url": "https://api.github.com/users/kemu3007/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3898939400, "node_id": "LA_kwDOG7qoq87oZRgI", "url": "https://api.github.com/repos/kemu3007/portal/labels/article", "name": "article", "color": "C200E5", "default": false, "description": ""}, {"id": 3900074882, "node_id": "LA_kwDOG7qoq87odmuC", "url": "https://api.github.com/repos/kemu3007/portal/labels/Angular", "name": "Angular", "color": "D93F0B", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-05-17T15:15:57Z", "updated_at": "2022-05-17T16:00:18Z", "closed_at": null, "author_association": "OWNER", "active_lock_reason": null, "body": "When deploying SPA to GitHub Pages, CloudFlare Pages, we will also explain what you need to pay attention to from the SEO perspective and how to do Angular deployment.\r\n\r\n## Angular deployment\r\n\r\n### GitHub Pages\r\n#### Build\r\n`` `bash\r\n$ NPM Run Build\r\n$ CP Portal/Dist/Portal/Index.html Portal/Dist/Portal/404.html\r\n`` `\r\n#### GitHub Actions\r\n`` `YML\r\nJobs:\r\n  DEPLOY:\r\n    RUNS-ON: Ubuntu-Latest\r\n    Steps:\r\n      ...\r\n      -Name: deploy gh-pages\r\n        USES: Peaceiris/Actions-GH-Pages@v3\r\n        with:\r\n          github_token: $ {{secrets.github_token}}}\r\n          Publish_dir: ./portal/dist/portal\r\n          CNAME: Portal.kemu.site\r\n`` `\r\n\r\nGitHub Pages refers to `404.html` if there is no file in the specified directory. Therefore, refer to `index.html` to` 404.html`.\r\n\r\n### Cloudflare Pages\r\n\r\nYou will use CloudFlare's GitHub linkage function or use it because it provides an uploaded Actions.\r\n\r\n[CloudFlare Pages Github Action]\r\n\r\n* `Uses: CloudFlare/Pages-Action@1` Described in the sample, but please note that if you do not list the version and fail if you do not write the version if you do not describe` uses: CloudFlare/Pages-Action@v1.0.0`. ã€‚\r\n\r\n## problem\r\n\r\n### Since there is only a file in the root directory, if you access a pass such as `blog/`, it will be `404`-> 200`.\r\n\r\nIf 404 occurs, Google Search Console determines the link as an illegal link and fails to register the index.\r\n\r\nThe same is true for 302. (Success only for URL inspection.)\r\n\r\n#### solution\r\n\r\nWhen hosting the server on your own, it is possible to respond by describing the Try_files of nginx, but it cannot be set with a managed service such as GitHub Pages, so the directory corresponding to all URLs is the route `index.html`. Copy and place it.\r\n\r\nUntil now, we had prepared a dummy page for GoogleBot and sorted by UserAgent, but there was a complexity of the management of the dummy page and the fight against mobile -friendly judgment, so it was a little troublesome. I tried to place a large amount of `.\r\n\r\nIt is better not to generate the difference between GoogleBot and the user as much as possible, and recent GoogleBot should read the Angular code as much as possible from such a viewpoint to perform crawling in an interpretation of Angular code.\r\n\r\nIt is possible to prevent the occurrence of 404 by using a router function such as USEhash and such as `/#/blog/`, but the search result of Google is a regular URL containing `#`. It is the worst in SEO because it becomes converted.\r\n\r\nIf you share ### Twitter, Twitter bot does not read OGP because it does not process JS.\r\n\r\nIf a site like a blog does not allow OGP to be deployed when sharing Twitter, the number of inflows to the site will be significantly reduced.\r\n\r\n#### solution\r\n\r\nPrepare another page with OGP, turn the Twitter shared link to the OGP dedicated page, and transition to the correct URL when the user accesses the OGP dedicated page.\r\n\r\nThe behavior of the tweet button can be changed by describing parameters such as `data-url` as follows.\r\n\r\nThis time, instead of the current link, the link with `$` at the top is displayed at the time of tweet, and on the page of the change destination, set the JS to redirect the `$` deleted page.\r\n\r\n`` `TS\r\nImport {component, afterviewinit} from '@Angular/Core';\r\n\r\n@Component ({\r\n  Selector: 'App-Tweet-BTN',\r\n  Template: `<div style =\" Height: 30px; \">\r\n    <a id = \"btn\" href = \"https://twitter.com/share?ref_sref_src=twsrc5etfw\" class = \"twitter-share-button\" [attr.data-url] = \"url\" = \"url\"\r\n      > Tweet </A\r\n    >\r\n  </Div> `,\r\n})\r\nExport Class Tweetbtncomponent IMPLEMENTS AFTERVIEWINIT {\r\n  NGAFTERVIEWINIT (): VOID {\r\n    CONST Script = document.createelement ('Script');\r\n    Script.async = true;\r\n    script.src = 'https://platform.twitter.com/widgets.js';\r\n    Cons btn = document.getelementbyid ('btn')!;\r\n    btn.insertadJACENTELEMENT ('afterend', script);\r\n  }\r\n\r\n  Get URL () {\r\n    Return Window.location.origin + '/$' + Window.location.pathname + Window.location.Search;\r\n  }\r\n}\r\n`` `\r\n\r\nRedirect to `/$/blog/`->`/blog/`, and prepare a dummy page that provides OGP for only Twitter bots that do not interpret JS.\r\n\r\nThe above two points are problems on SEO and their countermeasures.\r\n\r\nIf there are any SEO problems and improvements in the future, I will summarize it in another article.", "reactions": {"url": "https://api.github.com/repos/kemu3007/portal/issues/44/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/kemu3007/portal/issues/44/timeline", "performed_via_github_app": null, "state_reason": null}