{"url": "https://api.github.com/repos/kemu3007/portal/issues/48", "repository_url": "https://api.github.com/repos/kemu3007/portal", "labels_url": "https://api.github.com/repos/kemu3007/portal/issues/48/labels{/name}", "comments_url": "https://api.github.com/repos/kemu3007/portal/issues/48/comments", "events_url": "https://api.github.com/repos/kemu3007/portal/issues/48/events", "html_url": "https://github.com/kemu3007/portal/issues/48", "id": 1251755523, "node_id": "I_kwDOG7qoq85KnEYD", "number": 48, "title": "Perform error tracking with Angular Sentry", "user": {"login": "kemu3007", "id": 29157528, "node_id": "MDQ6VXNlcjI5MTU3NTI4", "avatar_url": "https://avatars.githubusercontent.com/u/29157528?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kemu3007", "html_url": "https://github.com/kemu3007", "followers_url": "https://api.github.com/users/kemu3007/followers", "following_url": "https://api.github.com/users/kemu3007/following{/other_user}", "gists_url": "https://api.github.com/users/kemu3007/gists{/gist_id}", "starred_url": "https://api.github.com/users/kemu3007/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kemu3007/subscriptions", "organizations_url": "https://api.github.com/users/kemu3007/orgs", "repos_url": "https://api.github.com/users/kemu3007/repos", "events_url": "https://api.github.com/users/kemu3007/events{/privacy}", "received_events_url": "https://api.github.com/users/kemu3007/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3898939400, "node_id": "LA_kwDOG7qoq87oZRgI", "url": "https://api.github.com/repos/kemu3007/portal/labels/article", "name": "article", "color": "C200E5", "default": false, "description": ""}, {"id": 3900074882, "node_id": "LA_kwDOG7qoq87odmuC", "url": "https://api.github.com/repos/kemu3007/portal/labels/Angular", "name": "Angular", "color": "D93F0B", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-05-29T00:46:42Z", "updated_at": "2022-05-29T00:46:42Z", "closed_at": null, "author_association": "OWNER", "active_lock_reason": null, "body": "## Introduction\r\n\r\n`` `bash\r\n$ NPM I @Sentry/Angular @sentry/Tracing\r\n`` `\r\n\r\n## EnvironMent\r\n\r\nSince error tracking is not performed in the development environment, DSN is described only in `environment.prod.ts`.\r\nDSN can be obtained with `Settings> Projects> Client Keys`.\r\n\r\n-Environment.ts\r\n\r\n`` `TS\r\nEXPORT CONST ENVIRONMENT: ENV = {\r\n  Sentrydsn: '',\r\n};\r\n\r\n`` `\r\n-Environment.prod.ts\r\n\r\n`` `TS\r\nEXPORT CONST ENVIRONMENT: ENV = {\r\n  Sentrydsn: '*****************************\r\n};\r\n`` `\r\n\r\n## main.ts\r\n\r\nBy reducing Tracessamplerate, you can reduce the number of times the same error is sent.\r\n\r\n1.0: Send all errors to Sentry\r\n\r\n`` `TS\r\nImport * as Sentry from '@Sentry/Angular';\r\nImport {browsertracing} from '@sentry/Tracing';\r\n\r\nSentry.init ({\r\n  dsn: environMent.Sentrydsn,\r\n  Integrations: [\r\n    New Browsertracing ({\r\n      Tracingorigins: ['localhost',' https://portal.kemu.site '],\r\n      RoutinginStrumentation: Sentry.routinginStrection,\r\n    }),\r\n  ],,\r\n  Tracessamplerate: 1.0,\r\n});\r\n\r\nIF (EnvironMent.production) {\r\n  ENABLEPRODMODE ();\r\n}\r\n\r\nPlatformBrowserdynamic ()\r\n  .bootStrapmodule (Appmodule)\r\n  .catch ((ERR) => Console.error (ERR));\r\n`` `\r\n\r\n## app.module.ts\r\n\r\nShowdialog can launch the foam dialog in the event of an error by turning TRUE and have the user send crash data.\r\n\r\n`` `TS\r\nImport {ApproutingModule} from './app-Routing.module';\r\nImport {AppComponent} from './app.component';\r\nImport {app_initalizer, errorHandler, ngmodule} from '@Angular/Core';\r\nImport {browserModule} from '@Angular/Platform-Brewser';\r\nImport {Router} from '@Angular/Router';\r\nImport * as Sentry from '@Sentry/Angular';\r\n\r\n@Ngmodule ({\r\n  DECLARATIONS: [AppComponent],\r\n  Imports: [Browsermodule, ApproutingModule],\r\n  Providers: [\r\n    {Provide: errorHandler, useverue: Sentry.createrrorHandler ({Showdialog: False})},\r\n    {Provide: Sentry.Traceservice, DEPS: [Router]},\r\n    {Provide: App_initalizer, USFACTORY: () => () => {}, DEPS: [Sentry.Traceservice], Multi: True},\r\n  ],,\r\n  Bootstrap: [AppComponent],\r\n})\r\nExport Class Appmodule {}\r\n`` `\r\n\r\nThe error is now notified to Sentry.\r\n\r\nIf you want to test a notification to Sentry, you can use `Throw New Error ('Test Exception!');` In any part.\r\n \r\nCreate ## SourceMap\r\n\r\nAngular is difficult to read at the time of Build, making it difficult to see the error content from the Sentry. Therefore, the source map is generated at the time of building and entered in the sentrality.\r\n\r\n-Creating SourceMap\r\n\r\n`` `bash\r\n$ NPM Run Build ---sourcemap = True\r\n`` `\r\n\r\nUpload it using the GitHub Actions workflow.\r\n\r\nhttps://github.com/marketplace/actions/sentry- Release\r\n\r\nAt this time, you need to issue a token on the Sentry side.\r\n\r\nSettings> Developer Settings> Create New Integration> Internal Integration\r\n\r\nSet the authority as follows, and register the token as `sentry_auth_token` in the gitHub secrets.\r\n\r\n! [Image] (https://user- Images.githubuserContent.com/29157528/170847335-d3C22049-F20D-401A-84ED-3C6B0F785C.png)\r\n\r\nAlso, set the same for `sentry_org`,` sentry_project`.\r\n\r\nSentry_org: `Settings> General Settings> Organization Slug`\r\nSentry_project: `Settings> Projects> Name`\r\n\r\n-Deploy.yml\r\n\r\n`` `YML\r\nJobs:\r\n  DEPLOY:\r\n    RUNS-ON: Ubuntu-Latest\r\n    Strategy:\r\n      Matrix:\r\n        Node-Version: ['16']\r\n    Steps:\r\n      -uses: Actions/checkout@v3\r\n        with:\r\n          fetch-depth: 0\r\n      -Name: Install DEPS\r\n        Run: |\r\n          NPM Install\r\n      -Name: Build\r\n        Run: |\r\n          NPM RUN NG Build ---sourcemap = True | & Tee -a $ GitHub_step_summary\r\n      -uses: getSentry/action-release@v1\r\n        ENV:\r\n          Sentry_auth_token: $ {{Secrets.Sentry_auth_token}}}}}\r\n          Sentry_org: $ {{Secrets.Sentry_org}}}\r\n          Sentry_project: $ {{Secrets.Sentry_project}}}\r\n        with:\r\n          SourceMaps: './dict/'\r\n`` `\r\n\r\nIf you do not set fetch-depth, you will get an error. Since only one commit is obtained by default, it seems that it will be moss by creating version tags when uploading to Sentry. (You can avoid errors even if set_commits is Skip.)\r\n\r\n## At the end\r\n\r\nIn the above steps, I was able to create a Sentry automatic release flow safely. Recently, I have prepared GitHub Actions Workflow and I feel it is very convenient.", "reactions": {"url": "https://api.github.com/repos/kemu3007/portal/issues/48/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/kemu3007/portal/issues/48/timeline", "performed_via_github_app": null, "state_reason": null}