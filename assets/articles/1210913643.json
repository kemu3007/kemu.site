{"url": "https://api.github.com/repos/kemu3007/portal/issues/34", "repository_url": "https://api.github.com/repos/kemu3007/portal", "labels_url": "https://api.github.com/repos/kemu3007/portal/issues/34/labels{/name}", "comments_url": "https://api.github.com/repos/kemu3007/portal/issues/34/comments", "events_url": "https://api.github.com/repos/kemu3007/portal/issues/34/events", "html_url": "https://github.com/kemu3007/portal/issues/34", "id": 1210913643, "node_id": "I_kwDOG7qoq85ILRNr", "number": 34, "title": "Django JWT\u8a8d\u8a3c\u3092\u5229\u7528\u3059\u308b", "user": {"login": "kemu3007", "id": 29157528, "node_id": "MDQ6VXNlcjI5MTU3NTI4", "avatar_url": "https://avatars.githubusercontent.com/u/29157528?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kemu3007", "html_url": "https://github.com/kemu3007", "followers_url": "https://api.github.com/users/kemu3007/followers", "following_url": "https://api.github.com/users/kemu3007/following{/other_user}", "gists_url": "https://api.github.com/users/kemu3007/gists{/gist_id}", "starred_url": "https://api.github.com/users/kemu3007/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kemu3007/subscriptions", "organizations_url": "https://api.github.com/users/kemu3007/orgs", "repos_url": "https://api.github.com/users/kemu3007/repos", "events_url": "https://api.github.com/users/kemu3007/events{/privacy}", "received_events_url": "https://api.github.com/users/kemu3007/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3898939400, "node_id": "LA_kwDOG7qoq87oZRgI", "url": "https://api.github.com/repos/kemu3007/portal/labels/article", "name": "article", "color": "C200E5", "default": false, "description": ""}, {"id": 3900075763, "node_id": "LA_kwDOG7qoq87odm7z", "url": "https://api.github.com/repos/kemu3007/portal/labels/Django", "name": "Django", "color": "5FC353", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-04-21T11:40:05Z", "updated_at": "2022-04-21T11:40:05Z", "closed_at": null, "author_association": "OWNER", "active_lock_reason": null, "body": "## \u5c0e\u5165\r\n\r\n- \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\r\n\r\n```zsh\r\npip install djangorestframework djangorestframework-simplejwt\r\n```\r\n\r\n- settings.py\r\n\r\n```python\r\nINSTALLED_APPS = [\r\n    ...\r\n    \"rest_framework\",\r\n    \"rest_framework_simplejwt\",\r\n]\r\nREST_FRAMEWORK = {\r\n    ...\r\n    \"DEFAULT_AUTHENTICATION_CLASSES\": (\r\n        ...\r\n        \"rest_framework_simplejwt.authentication.JWTAuthentication\",\r\n    )\r\n}\r\n```\r\n\r\n- urls.py\r\n\r\n\t- \u57fa\u672c\u7684\u306aAPI View\u306b\u95a2\u3057\u3066\u306f\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3068\u308a\u3042\u3048\u305a\u5c0e\u5165\r\n\t- `TokenObtainPairView` : \u30c8\u30fc\u30af\u30f3\u306e\u751f\u6210\r\n\t- `TokenRefreshView` : \u30c8\u30fc\u30af\u30f3\u306e\u518d\u767a\u884c\r\n\t- `TokenVerifyView ` : \u30c8\u30fc\u30af\u30f3\u306e\u6709\u52b9\u6027\u78ba\u8a8d\r\n\t- \u4ed6\u306b\u3082blacklist\u306a\u3069\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u3059\u3002\r\n\r\n```python\r\nfrom django.urls import include, path\r\nfrom rest_framework_simplejwt.views import TokenObtainPairView, TokenRefreshView, TokenVerifyView\r\n\r\njwt_urls = [\r\n    path(\"\", TokenObtainPairView.as_view()),\r\n    path(\"refresh/\", TokenRefreshView.as_view()),\r\n    path(\"verify/\", TokenVerifyView.as_view()),\r\n]\r\n\r\nurlpatterns = [\r\n    path(\"token/\", include(jwt_urls)),\r\n]\r\n```\r\n\r\n## \u52d5\u4f5c\u78ba\u8a8d\r\n\r\n### \u30c8\u30fc\u30af\u30f3\u306e\u767a\u884c\r\n\r\n\u9069\u5f53\u306b\u30e6\u30fc\u30b6\u3092\u4f5c\u6210\u3057\u3001`token/` \u306b\u30e6\u30fc\u30b6\u540d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u3092POST\r\n\r\n- \u30ec\u30b9\u30dd\u30f3\u30b9\r\n\t- `access` \u306fAPI\u306e\u5229\u7528\u6642\u306b\u30d8\u30c3\u30c0\u306b `Authorization: Bearer {accesskey}` \u3068\u3057\u3066\u5229\u7528\u3059\u308b\u30c8\u30fc\u30af\u30f3\r\n\t- `refresh` \u306f\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u518d\u767a\u884c\u3059\u308b\u305f\u3081\u306e\u30c8\u30fc\u30af\u30f3\r\n\r\n```json\r\n{\r\n    \"refresh\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0b2tlbl90eXBlIjoicmVmcmVzaCIsImV4cCI6MTY1MDYyNTc2MiwiaWF0IjoxNjUwNTM5MzYyLCJqdGkiOiJmYjg3M2QzY2RjZTc0YTYzYmQ3ZTQ1OTQ5YjdiN2MxOSIsInVzZXJfaWQiOjJ9.8djfRV1zYHUyVFp5gelG2pTWWmT_QE1gqlLQLb1A2rw\",\r\n    \"access\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNjUwNTM5NjYyLCJpYXQiOjE2NTA1MzkzNjIsImp0aSI6ImI4NDU0YTdiMDM3YzRhOWRiMmRjYWRmNTMwMjkwNDMxIiwidXNlcl9pZCI6Mn0.TwIRKSO-Pi6ZZMrJ10DOHTrdVoZtLRasB9vjvdBANIQ\"\r\n}\r\n```\r\n\r\n### \u30c8\u30fc\u30af\u30f3\u306e\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\r\n\r\n\u5148\u306e\u5de5\u7a0b\u3067\u53d6\u5f97\u3057\u305f `refresh`\u30c8\u30fc\u30af\u30f3\u3092 `token/refresh/` \u306bPOST\r\n\r\n- \u30ec\u30b9\u30dd\u30f3\u30b9\r\n\r\n```json\r\n{\r\n    \"access\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNjUwNTM5OTMwLCJpYXQiOjE2NTA1MzkzNjIsImp0aSI6IjQ2YzI2OThmOTFmYjQ0ZjY5OWVkNzk4NTY1MmY5MGNmIiwidXNlcl9pZCI6Mn0.IsNvx4DFhZoeW48fShWpwNRoO7_JZ69ws-1XhGuDx3I\"\r\n}\r\n```\r\n\r\n### \u30c8\u30fc\u30af\u30f3\u306e\u6709\u52b9\u6027\u78ba\u8a8d\r\n\r\n\u30c8\u30fc\u30af\u30f3\u3092 `token/verify/` \u306bPOST\r\n\r\n- \u30ec\u30b9\u30dd\u30f3\u30b9\r\n  - 200 OK\u306e\u307f\u8fd4\u5374\u3055\u308c\u308b\r\n  - \u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3001\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u30c8\u30fc\u30af\u30f3\u3069\u3061\u3089\u3082\u6709\u52b9\u6027\u78ba\u8a8d\u53ef\u80fd\r\n  - \u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u30c8\u30fc\u30af\u30f3\u304c\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u3055\u308c\u305f\u5834\u5408\u3067\u3082\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u524d\u306e\u30c8\u30fc\u30af\u30f3\u304c\u6709\u52b9\u671f\u9650\u5185\u3067\u3042\u308c\u3070\u5229\u7528\u53ef\u80fd\r\n    - `BLACKLIST_AFTER_ROTATION` \u3092True\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\r\n  - \u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u4e00\u3064\u306e\u30e6\u30fc\u30b6\u306b\u7d10\u3065\u304f\u30c8\u30fc\u30af\u30f3\u3092\u8907\u6570\u4f5c\u6210\u3067\u304d\u308b\u305f\u3081\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u7684\u306a\u9762\u3067\u8abf\u6574\u304c\u5fc5\u8981\u305d\u3046\r\n    - \u3084\u308a\u65b9\u306f\u8981\u78ba\u8a8d ( \u8a2d\u5b9a\u3067\u3042\u308a\u305d\u3046\u306a\u6c17\u304c\u3059\u308b )\r\n\r\n```json\r\n{}\r\n```\r\n\r\n### \u30c8\u30fc\u30af\u30f3\u3092\u4ed8\u4e0e\u3057\u3066\u30ed\u30b0\u30a4\u30f3\u304c\u5fc5\u8981\u306a\u30da\u30fc\u30b8\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\r\n- `curl`\r\n\r\n```bash\r\n$ curl localhost:8080/api/v1/user/ -H \"Authorization: Bearer{accesskey}\"\r\n```\r\n\r\n- `rest_framework.test.APIClient`\r\n\r\n```python\r\nclient = APIClient().credentials(HTTP_AUTHORIZATION=f\"Bearer {accesskey}\")\r\nclient.get(\"localhost:8080/api/v1/user/\")\r\n```\r\n\r\n\u30c8\u30fc\u30af\u30f3\u304c\u6709\u52b9\u3067\u3042\u308c\u3070200\u3001\u4e0d\u6b63\u3067\u3042\u308c\u3070401\u304c\u8fd4\u5374\u3055\u308c\u307e\u3059\u3002\r\n\r\n## \u7d42\u308f\u308a\u306b\r\n\r\n\u30c8\u30fc\u30af\u30f3\u8a8d\u8a3c\u306fCORS\u3092\u6c17\u306b\u3057\u306a\u304f\u3066\u826f\u304f\u4f7f\u3044\u3084\u3059\u3044\u53cd\u9762\u3061\u3087\u3063\u3068\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u7684\u306b\u6016\u3044\u306a\u3068\u611f\u3058\u305f\u3002\r\n\u30d5\u30ed\u30f3\u30c8\u5074\u3067\u3069\u3053\u306b\u30c8\u30fc\u30af\u30f3\u3092\u6301\u3064\u3079\u304d\u306a\u3093\u3060\u308d\u3046\u304bHTTP Only Cookie? LocalStorage/SessionStorage?\r\n\r\n\u30c8\u30fc\u30af\u30f3\u304c\u76d7\u307e\u308c\u308b\u30b1\u30fc\u30b9\u3092\u524d\u63d0\u306b\u304a\u3044\u3066\u65e2\u5b58\u306e\u30c8\u30fc\u30af\u30f3\u7121\u52b9\u5316\u3059\u308b\u6a5f\u80fd/\u6709\u52b9\u671f\u9650\u3092\u77ed\u304f\u8a2d\u5b9a\u3057\u3066\u304a\u304f\u3068\u3044\u3063\u305f\u5bfe\u5fdc\u304c\u5fc5\u8981\u306b\u306a\u308b\u3002\r\n\r\n\u4eca\u56de\u306e\u30b3\u30fc\u30c9: https://github.com/kemu3007/django-jwt-sample\r\n", "reactions": {"url": "https://api.github.com/repos/kemu3007/portal/issues/34/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/kemu3007/portal/issues/34/timeline", "performed_via_github_app": null}