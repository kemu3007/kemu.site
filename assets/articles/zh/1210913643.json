{
  "url": "https://api.github.com/repos/kemu3007/portal/issues/34",
  "repository_url": "https://api.github.com/repos/kemu3007/portal",
  "labels_url": "https://api.github.com/repos/kemu3007/portal/issues/34/labels{/name}",
  "comments_url": "https://api.github.com/repos/kemu3007/portal/issues/34/comments",
  "events_url": "https://api.github.com/repos/kemu3007/portal/issues/34/events",
  "html_url": "https://github.com/kemu3007/portal/issues/34",
  "id": 1210913643,
  "node_id": "I_kwDOG7qoq85ILRNr",
  "number": 34,
  "title": "使用Django JWT认证",
  "user": {
    "login": "kemu3007",
    "id": 29157528,
    "node_id": "MDQ6VXNlcjI5MTU3NTI4",
    "avatar_url": "https://avatars.githubusercontent.com/u/29157528?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kemu3007",
    "html_url": "https://github.com/kemu3007",
    "followers_url": "https://api.github.com/users/kemu3007/followers",
    "following_url": "https://api.github.com/users/kemu3007/following{/other_user}",
    "gists_url": "https://api.github.com/users/kemu3007/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kemu3007/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kemu3007/subscriptions",
    "organizations_url": "https://api.github.com/users/kemu3007/orgs",
    "repos_url": "https://api.github.com/users/kemu3007/repos",
    "events_url": "https://api.github.com/users/kemu3007/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kemu3007/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3898939400,
      "node_id": "LA_kwDOG7qoq87oZRgI",
      "url": "https://api.github.com/repos/kemu3007/portal/labels/article",
      "name": "article",
      "color": "C200E5",
      "default": false,
      "description": ""
    },
    {
      "id": 3900075763,
      "node_id": "LA_kwDOG7qoq87odm7z",
      "url": "https://api.github.com/repos/kemu3007/portal/labels/Django",
      "name": "Django",
      "color": "5FC353",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 0,
  "created_at": "2022-04-21T11:40:05Z",
  "updated_at": "2022-04-22T09:48:26Z",
  "closed_at": null,
  "author_association": "OWNER",
  "active_lock_reason": null,
  "body": "\n## ＃＃介绍\n\n-  安装\n\n```zsh\n$ pip install djangorestframework djangorestframework-simplejwt\n```\n\n-  设置.py\n\n```python\nINSTALLED_APPS = [\n    ...\n    \"rest_framework\",\n    \"rest_framework_simplejwt\",\n]\nREST_FRAMEWORK = {\n    ...\n    \"DEFAULT_AUTHENTICATION_CLASSES\": (\n        ...\n        \"rest_framework_simplejwt.authentication.JWTAuthentication\",\n    )\n}\n```\n\n-  urls.py。\n\n-  暂时引入，因为它是在基本的API视图方面提供的。\n-  `TokenObtainPairView` : 代币生成。\n-  `TokenRefreshView`：重新发行令牌。\n-  `TokenVerifyView `：令牌验证\n-  还提供其他服务，如黑名单。\n\n```python\nfrom django.urls import include, path\nfrom rest_framework_simplejwt.views import TokenObtainPairView, TokenRefreshView, TokenVerifyView\n\njwt_urls = [\n    path(\"\", TokenObtainPairView.as_view()),\n    path(\"refresh/\", TokenRefreshView.as_view()),\n    path(\"verify/\", TokenVerifyView.as_view()),\n]\n\nurlpatterns = [\n    path(\"token/\", include(jwt_urls)),\n]\n```\n\n## 检查操作\n\n### 发放代币\n\n创建一个合适的用户，将用户名和密码POST到`token/`。\n\n-  回应\n-  `access'是一个令牌，在使用API时作为 \"Authorisation: Bearer {accessskey}\"在标头中使用。\n-  `refresh`是一个令牌，用于重新签发访问令牌\n\n```json\n{\n    \"refresh\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0b2tlbl90eXBlIjoicmVmcmVzaCIsImV4cCI6MTY1MDYyNTc2MiwiaWF0IjoxNjUwNTM5MzYyLCJqdGkiOiJmYjg3M2QzY2RjZTc0YTYzYmQ3ZTQ1OTQ5YjdiN2MxOSIsInVzZXJfaWQiOjJ9.8djfRV1zYHUyVFp5gelG2pTWWmT_QE1gqlLQLb1A2rw\",\n    \"access\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNjUwNTM5NjYyLCJpYXQiOjE2NTA1MzkzNjIsImp0aSI6ImI4NDU0YTdiMDM3YzRhOWRiMmRjYWRmNTMwMjkwNDMxIiwidXNlcl9pZCI6Mn0.TwIRKSO-Pi6ZZMrJ10DOHTrdVoZtLRasB9vjvdBANIQ\"\n}\n```\n\n###刷新令牌。\n\n将上一步获得的 \"refresh \"令牌POST到 \"token/refresh/\"。\n\n-  回应\n\n```json\n{\n    \"access\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNjUwNTM5OTMwLCJpYXQiOjE2NTA1MzkzNjIsImp0aSI6IjQ2YzI2OThmOTFmYjQ0ZjY5OWVkNzk4NTY1MmY5MGNmIiwidXNlcl9pZCI6Mn0.IsNvx4DFhZoeW48fShWpwNRoO7_JZ69ws-1XhGuDx3I\"\n}\n```\n\n### 检查令牌的有效性\n\nPOST令牌到`token/verify/`。\n\n-  回应\n  -  只返回200 OK\n  -  对访问和刷新令牌都可以进行有效性检查。\n  -  默认情况下，如果一个令牌被刷新，如果刷新前的令牌仍然有效，它仍然可以被使用。\n    -  `BLACKLIST_AFTER_ROTATION`需要被设置为True。\n  -  安全方面可能需要调整，因为可以创建多个令牌，这些令牌默认与一个用户相连。\n    -  如何做到这一点需要确认（我想可能在设置中）。\n\n```json\n{}\n```\n\n###授予一个令牌来访问需要登录的页面。\n-  \"卷曲\"。\n\n```bash\n$ curl localhost:8080/api/v1/user/ -H \"Authorization: Bearer{accesskey}\"\n```\n\n-  `rest_framework.test.APIClient`。\n\n```python\nclient = APIClient().credentials(HTTP_AUTHORIZATION=f\"Bearer {accesskey}\")\nclient.get(\"localhost:8080/api/v1/user/\")\n```\n\n如果令牌有效则返回200，无效则返回401。\n\n##结束。\n\n令牌认证很容易使用，因为你不必担心CORS，但同时从安全的角度来看，它又有点可怕。\n我们应该在前台设置令牌，HTTP Only Cookies？ LocalStorage/SessionStorage？\n\n有必要采取一些措施，如设置一个功能，使现有的代币失效/缩短有效期，假设代币被盗。\n\n这次的代码：https://github.com/kemu3007/django- jwt- sample",
  "reactions": {
    "url": "https://api.github.com/repos/kemu3007/portal/issues/34/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/kemu3007/portal/issues/34/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
